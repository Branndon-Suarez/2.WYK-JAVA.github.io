<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/heads/headDashboard :: headDashboard}"></head>
<body>
    <div class="app">
        <!-- SIDEBAR -->
        <div th:replace="~{layout/sidebar :: sidebar}"></div>

        <!-- MODAL FILTROS -->
<!--        <div th:replace="roles/modalConsultas :: modalConsultas"></div>-->

        <main class="main">
            <!-- TOPBAR -->
            <header>
                <strong>PANADER√çA WYK ‚Äî Panel Control</strong>

                <div class="search">
                    <lord-icon
                            src="https://cdn.lordicon.com/vhdgmtyj.json"
                            trigger="hover"
                            stroke="bold"
                            colors="primary:#933e0d"
                            style="width:50px;height:50px">
                    </lord-icon>

                    <input id="buscarRapido" placeholder="Buscar‚Ä¶"/>

                    <button type="button" class="btn btn-ghost"
                            data-bs-toggle="modal" data-bs-target="#filtroAvanzadoModal">
                        <i data-feather="sliders" style="width:18px;height:18px;color:#94a3b8;"></i>
                    </button>
                </div>

                <a th:href="@{/roles/formGuardar}">
                    <button type="button" class="btn btn-primary">+ Nuevo rol</button>
                </a>
            </header>


            <div class="layout">
                <!-- HERO -->
                <section class="hero">
                    <div>
                        <div class="hero-note">¬°Buen d√≠a!</div>
                        <h2>Bienvenidos,
<!--                            <span style="color:var(&#45;&#45;primary)" th:text="${userName}"></span>-->
                        </h2>

                        <div class="hero-note">Que el aroma del pan reci√©n horneado te acompa√±e hoy üçû</div>

                        <div style="margin-top:12px; display:flex; gap:10px;">
                            <button class="btn btn-ghost">Ver agenda</button>
                        </div>
                    </div>

                    <div class="illus">
                        <div class="floaty"></div>
                        <div class="bread">ü•ñ</div>
                        <div class="croissant">ü•ê</div>
                    </div>
                </section>


                <!-- KPIs -->
                <section class="stats">
                    <div class="stat">
                        <div>
                            <div class="muted">Roles existentes</div>
                            <div class="kpi" th:text="${rolesExistentes}"></div>
                        </div>
                        <div class="icon">
                            <lord-icon
                                    src="https://cdn.lordicon.com/oqhqyeud.json"
                                    trigger="hover"
                                    stroke="bold"
                                    colors="primary:#933e0d,secondary:#933e0d"
                                    style="width:40px;height:40px">
                            </lord-icon>
                        </div>
                    </div>

                    <div class="stat">
                        <div>
                            <div class="muted">Roles activos</div>
                            <div class="kpi" th:text="${rolesActivos}"></div>
                        </div>
                        <div class="icon">
                            <lord-icon
                                    src="https://cdn.lordicon.com/oqhqyeud.json"
                                    trigger="hover"
                                    stroke="bold"
                                    colors="primary:#933e0d,secondary:#933e0d"
                                    style="width:40px;height:40px">
                            </lord-icon>
                        </div>
                    </div>

                    <div class="stat">
                        <div>
                            <div class="muted">Roles inactivos</div>
                            <div class="kpi" th:text="${rolesInactivos}"></div>
                        </div>
                        <div class="icon">
                            <lord-icon
                                    src="https://cdn.lordicon.com/oqhqyeud.json"
                                    trigger="hover"
                                    stroke="bold"
                                    colors="primary:#933e0d,secondary:#933e0d"
                                    style="width:40px;height:40px">
                            </lord-icon>
                        </div>
                    </div>
                </section>


                <!-- TABLA DE ROLES -->
                <div class="section-reportes">
                    <div class="table-header">
                        <strong>Tabla de roles</strong>
                        <button id="generatePdfBtn" style="display:flex; align-items:center;" class="btn btn-ghost btp-personalizado">
                            <span>Generar PDF</span>
                            <lord-icon
                                    src="https://cdn.lordicon.com/gyyhoycg.json"
                                    trigger="hover"
                                    stroke="bold"
                                    colors="primary:#fff"
                                    style="width:50px;height:50px">
                            </lord-icon>
                        </button>
                    </div>

                    <table id="tablaRoles" class="tabla-consultas">
                        <thead>
                        <tr>
                            <th>Rol</th>
                            <th>Clasificaci√≥n</th>
                            <th>Estado</th>
                            <th colspan="3" style="text-align:center">Acciones</th>
                        </tr>
                        </thead>

                        <tbody>
                        <!-- SI HAY ROLES -->
                        <tr th:each="rol : ${listaRoles}">
                            <td th:text="${rol.rol}"></td>
                            <td th:text="${rol.clasificacion}"></td>

                            <td>
                                <input type="checkbox"
                                       th:id="'switch_' + ${rol.idRol}"
                                       th:data-id="${rol.idRol}"
                                       th:checked="${rol.estadoRol} == true">

                                <label th:for="'switch_' + ${rol.idRol}" class="check-trail">
                                    <span class="check-handler"></span>
                                </label>
                            </td>

                            <td>
                                <a th:href="@{/roles/formAct/{id}(id=${rol.idRol})}"
                                   class="btn btn-sm btn-primary btn-actualizar">
                                    <lord-icon
                                            src="https://cdn.lordicon.com/ibckyoan.json"
                                            trigger="hover"
                                            colors="primary:#ffffff"
                                            style="width:30px;height:30px">
                                    </lord-icon>
                                </a>
                            </td>

                            <td>
                                <button class="btn btn-sm btn-danger delete-rol"
                                        th:data-id="${rol.idRol}">
                                    <lord-icon
                                            src="https://cdn.lordicon.com/oqeixref.json"
                                            trigger="morph"
                                            state="morph-trash-full"
                                            colors="primary:#ffffff"
                                            style="width:30px;height:30px">
                                    </lord-icon>
                                </button>
                            </td>
                        </tr>

                        <!-- SI NO HAY ROLES -->
                        <tr th:if="${#lists.isEmpty(listaRoles)}">
                            <td colspan="5" style="text-align:center">No hay roles disponibles.</td>
                        </tr>

                        </tbody>
                    </table>
                </div>

            </div>
            <!-- MODAL CONSULTAS -->
            <div th:replace="~{/rol/modalConsultas :: modalConsultas}"></div>
            <!-- FOOTER -->
            <div th:replace="~{/layout/footers/footerDashboard :: footerDashboard}"></div>
        </main>
    </div>

    <!-- LIBRER√çAS -->
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"
            integrity="sha256-Lye89HGy1p3XhJT24hcvsoRw64Q4IOL5a7hdOflhjTA="
            crossorigin="anonymous">
    </script>

    <!-- VARIABLES GLOBALES -->
<!--    <script>-->
<!--        const APP_URL = /*[[${@environment.getProperty('app.url')}]]*/ '';-->
<!--    </script>-->

    <!-- JS DEL SISTEMA -->
    <script th:src="@{/js/dashboard.js}"></script>
    <script th:src="@{/js/sidebar.js}"></script>

    <!-- JS CRUD ROLES -->
<!--    Nota: vuelvo a llamar el script de sweetalert porque si no es cargando antes de ser usado-->
<!--    (como lo es en lso siguientes archivos js) no hay eventos al presionar el bot√≥n-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script th:src="@{/js/rol/confirmState.js}"></script>
    <script th:src="@{/js/rol/confirmDelete.js}"></script>

    <!-- BUSQUEDA Y PDF -->
    <script th:src="@{/js/rol/busquedaFiltro.js}"></script>
    <script th:src="@{/js/rol/PDFgenerateFilter.js}"></script>
</body>
</html>
