<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/heads/headLogin :: headLogin}"></head>

<body>
<main>
    <div class="container">
        <div class="forms-container">
            <div class="container-login">

                <form th:action="@{/login}" id="login-form" class="sign-in-form" method="post" autocomplete="on">
                    <h2 class="title">Iniciar Sesión</h2>

                    <div class="input-field">
                        <lord-icon
                                src="https://cdn.lordicon.com/fmasbomy.json"
                                trigger="hover"
                                stroke="bold"
                                colors="primary:#000000,secondary:#a63754,tertiary:#eeca66"
                                style="width:50px;height:50px"
                                id="icon_2-email">
                        </lord-icon>

<!--                        onpaste="return false;" oncopy="return false;" oncut="return false;"-->
                        <input type="email" name="username" class="form-control" placeholder="Email"
                               required>
                    </div>

                    <div class="input-field">
                        <lord-icon
                                src="https://cdn.lordicon.com/zbbefawl.json"
                                trigger="hover"
                                style="width:50px;height:50px"
                                id="icon_2-password">
                        </lord-icon>

                        <input type="password" name="password" class="form-control" placeholder="Contraseña"
                               required>
                    </div>

                    <button type="submit" name="boton_login" class="btn solid">Iniciar Sesión</button>
                </form>
            </div>
        </div>

        <div class="panels-container">
            <div class="panel left-panel">
                <div class="content">
                    <h3>¿No estás registrado?</h3>
                    <p>
                        ¡Comunícate con el administrador del sistema!
                    </p>
                </div>
                <img th:src="@{/images/imgLogin/login-1.svg}" class="image" alt="Ilustración de Login">
            </div>
        </div>
    </div>
</main>

<script src="https://cdn.lordicon.com/lordicon.js" integrity="sha256-1C3IZn03j9193YxLyK8PoFh0a0rfXzXk5KhS3OiN53s=" crossorigin="anonymous"></script>
<script th:src="@{/js/sweetalert2.all.min.js}"></script>

<script th:inline="javascript">
    window.successMessage = '';
    window.errorMessage = '';

    // Captura las variables inyectadas por el controlador (Solución 1)
    const logoutSuccess = [[${logoutSuccess}]];
    const loginError = [[${loginError}]];

    // Si el controlador pasó el indicador de logout
    if (logoutSuccess) {
        window.successMessage = 'Sesión cerrada correctamente.';
    }

    // Si el controlador pasó el indicador de error
    if (loginError) {
        if (loginError === 'disabled') {
            window.errorMessage = 'Tu cuenta se encuentra inactiva. Contacta al administrador.';
        } else {
            // 'true', 'error' o cualquier otro fallo genérico
            window.errorMessage = 'Credenciales incorrectas. Verifica tu email y contraseña.';
        }
    }

    // Inicialización del DOM (Debe ir después de la definición de mensajes, pero antes de otros scripts si es necesario)
    const sign_in_btn = document.querySelector("#sign-in-btn");
    const container = document.querySelector(".container");
</script>
<script th:src="@{/js/toads-sweetalert2.js}"></script>

</body>
</html>