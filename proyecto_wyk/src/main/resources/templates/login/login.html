<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/heads/headLogin :: headLogin}"></head>

<body>
<main>
    <div class="container">
        <div class="forms-container">
            <div class="container-login">

                <form th:action="@{/login}" id="login-form" class="sign-in-form" method="post" autocomplete="on">
                    <h2 class="title">Iniciar Sesión</h2>

                    <div th:if="${param.error}" class="error-message">
                        Email o contraseña incorrectos. Verifica tus credenciales.
                    </div>
                    <div th:if="${param.logout}" class="success-message">
                        Sesión cerrada correctamente.
                    </div>

                    <div class="input-field">
                        <lord-icon
                                src="https://cdn.lordicon.com/fmasbomy.json"
                                trigger="hover"
                                stroke="bold"
                                colors="primary:#000000,secondary:#a63754,tertiary:#eeca66"
                                style="width:50px;height:50px"
                                id="icon_2-email">
                        </lord-icon>

                        <input type="email" name="username" class="form-control" placeholder="Email"
                               onpaste="return false;" oncopy="return false;" oncut="return false;" required>
                    </div>

                    <div class="input-field">
                        <lord-icon
                                src="https://cdn.lordicon.com/zbbefawl.json"
                                trigger="hover"
                                style="width:50px;height:50px"
                                id="icon_2-password">
                        </lord-icon>

                        <input type="password" name="password" class="form-control" placeholder="Contraseña"
                               onpaste="return false;" oncopy="return false;" oncut="return false;" required>
                    </div>

                    <button type="submit" name="boton_login" class="btn solid">Iniciar Sesión</button>
                </form>
            </div>
        </div>

        <div class="panels-container">
            <div class="panel left-panel">
                <div class="content">
                    <h3>¿No estás registrado?</h3>
                    <p>
                        ¡Comunícate con el administrador del sistema!
                    </p>
                </div>
                <img th:src="@{/images/imgLogin/login-1.svg}" class="image" alt="Ilustración de Login">
            </div>
        </div>
    </div>
</main>

<script th:src="@{/js/register.js}"></script>
<script th:src="@{/js/sweetalert2.all.min.js}"></script>
<script th:src="@{/js/toads-sweetalert2.js}"></script>
<script src="https://cdn.lordicon.com/lordicon.js" integrity="sha256-1C3IZn03j9193YxLyK8PoFh0a0rfXzXk5KhS3OiN53s=" crossorigin="anonymous"></script>

<script th:src="@{/js/sweetalert2.all.min.js}"></script>
<script th:src="@{/js/toads-sweetalert2.js}"></script>

<script th:src="@{/js/register.js}"></script>

<script>
    let successMessage = '';
    let errorMessage = '';

    const urlParams = new URLSearchParams(window.location.search);

    if (urlParams.has('logout')) {
        successMessage = 'Sesión cerrada correctamente.';
    } else if (urlParams.has('error')) {
        // Asignamos el mensaje al errorMessage global
        errorMessage = 'Credenciales incorrectas. Verifica tu email y contraseña.';
    }

    // El resto de scripts que no son de carga de archivos (como la lógica de contenedores)
    const sign_in_btn = document.querySelector("#sign-in-btn");
    const container = document.querySelector(".container");
</script>

<script src="https://cdn.lordicon.com/lordicon.js" integrity="sha256-1C3IZn03j9193YxLyK8PoFh0a0rfXzXk5KhS3OiN53s=" crossorigin="anonymous"></script>

<script th:src="@{/js/sweetalert2.all.min.js}"></script>
<script th:src="@{/js/toads-sweetalert2.js}"></script>
<script th:src="@{/js/register.js}"></script>
</body>
</html>